#!/usr/bin/env bash

# RUN:
# $ chmod +x ~/path/to/.install
# $ ~/path/to/.install


# Close any open System Preferences panes, to prevent them from overriding
# settings weâ€™re about to change
osascript -e 'tell application "System Preferences" to quit'

# # Ask password
sudo -v

# Keep-alive: update existing `sudo` time stamp until `.macos` has finished
while true; do sudo -n true; sleep 60; kill -0 "$$" || exit; done 2>/dev/null &

# Get current dir (so run this script from anywhere)
export DOTFILES_DIR DOTFILES_CACHE DOTFILES_EXTRA_DIR
DOTFILES_DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

# Package managers & packages
. "$DOTFILES_DIR/install/brew.sh"
. "$DOTFILES_DIR/install/brew-cask.sh"
. "$DOTFILES_DIR/install/pip.sh"

# Bunch of hardlinks to hardlink files in this directory to your home directory
hln "$DOTFILES_DIR/.bash_profile" ~/.bash_profile
hln "$DOTFILES_DIR/.gitconfig" ~/.gitconfig
hln "$DOTFILES_DIR/.hyper.js" ~/.hyper.js
hln "$DOTFILES_DIR/.update" ~/.update

# RUBYGEM install/update
gem update --system  # you might need to be an administrator or root

# JEKYLL install
gem install jekyll bundler

# Run macOS defaults
. "$DOTFILES_DIR/.newmac"

#!/usr/bin/env bash

# Close any open System Preferences panes, to prevent them from overriding
# settings weâ€™re about to change
osascript -e 'tell application "System Preferences" to quit'

# Ask password
sudo -v

# Keep-alive: update existing `sudo` time stamp until `.macos` has finished
while true; do sudo -n true; sleep 60; kill -0 "$$" || exit; done 2>/dev/null &

# Package managers & packages
. "$ROOT_DIR/install/brew"
. "$ROOT_DIR/install/brew-cask"
. "$ROOT_DIR/install/pip"
. "$ROOT_DIR/install/apm"

# Bunch of symlinks from files in this directory to your home directory
# these are all hardlinks. I kept getting the message "Too many levels
# of symbolic links. This is probably because the .bash_profile file
# links to the other . files, which are symlinks to this repo."
ln -fv $ROOT_DIR/bash/.aliases ~
ln -fv $ROOT_DIR/bash/.bash_profile ~
ln -fv $ROOT_DIR/bash/.bash_prompt ~
ln -fv $ROOT_DIR/bash/.exports ~
ln -fv $ROOT_DIR/bash/.functions ~
ln -fv $ROOT_DIR/git/.gitconfig ~
ln -fv $ROOT_DIR/.hyper.js ~

# RUBYGEM install/update
sudo gem update --system  # you might need to be an administrator or root

# JEKYLL install
sudo gem install jekyll bundler

# Run macOS defaults
. "$ROOT_DIR/install/.macdefaults"

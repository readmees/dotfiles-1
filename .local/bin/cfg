#!/usr/bin/env bash

# Quickly edit a config file using file patterns
# Covers these cases:
#
# 1) `config` file in lvl 1 folder:
#       $ cfg git -> ~/.config/git/config
# 2) Exact path inside lvl 0 folder:
#       $ cfg readline/inputrc -> ~/.config/readline/inputrc
# 3) Some path in lvl 2 folder:
#       $ cfg ftplugin/python -> ~/.config/nvim/ftplugin/python.vim

[ -z "$1" ] && exit 20

config_path=${XDG_CONFIG_HOME:-$HOME/.config}

[ "$(command -v fdfind)" ] && fd=fdfind

if [ -f "$config_path/$1/config" ]; then
    result="$config_path/$1/config"
elif [ -f "$config_path/$1" ]; then
    result="$config_path/$1"
elif [ -f "$config_path/"*"/$1"* ]; then
    result=("$config_path/"*"/$1"*)
else
    result="$($fd -H --type file -d 3 "$1" "$config_path" | sed 1q)"
fi

[ -n "$result" -a -f "$result" ] && "$VISUAL" "$result"
